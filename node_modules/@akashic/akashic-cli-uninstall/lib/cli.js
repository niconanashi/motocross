"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var fs = require("fs");
var path = require("path");
var commander = require("commander");
var akashic_cli_commons_1 = require("@akashic/akashic-cli-commons");
var uninstall_1 = require("./uninstall");
function cli(param) {
    var logger = new akashic_cli_commons_1.ConsoleLogger({ quiet: param.quiet });
    var uninstallParam = { moduleNames: param.args, cwd: param.cwd, plugin: param.plugin, logger: logger, unlink: param.unlink };
    Promise.resolve()
        .then(function () { return uninstall_1.promiseUninstall(uninstallParam); })
        .catch(function (err) {
        logger.error(err, err.cause);
        process.exit(1);
    });
}
var ver = JSON.parse(fs.readFileSync(path.resolve(__dirname, "..", "package.json"), "utf8")).version;
commander
    .version(ver);
commander
    .description("Uninstall a node module and update globalScripts")
    .usage("[options] [moduleName ...]")
    .option("-l, --unlink", "Do npm unlink instead of npm uninstall")
    .option("-C, --cwd <dir>", "Specify directory includes game.json")
    .option("-q, --quiet", "Suppress output")
    .option("-p, --plugin", "Also remove from operationPlugins ", function (x) { return parseInt(x, 10); });
function run(argv) {
    commander.parse(argv);
    cli(commander);
}
exports.run = run;
